library(pwr)
library(tidyverse)
x <- c(1, 2, 3, 4, 8)
y <- c(4, 3, 5, 7, 9)
model <- (lm(y~x))
model
summary(model)
anova(model)
resid(model)
cov(x, y)
var(x)
var(y)
plot(y~x)
plot(model)
plot(y~x)
abline(model)
rm(list = ls())
d<- read.table("../data/Sparrowsize.txt", header = T)
view(d)
plot(d$Mass~d$Tarsus, ylab = "Mass (g)", xlab = "Tarsus (mm", pch = 19, cex = 0.4)
x <- c(1:100)
a <- 0.5
b <- 1.5
y <- b*x+a
plot(x, y, xlim = c(0,100), ylim = c(0, 100), pch = 19, cex = 0.5)
plot(x, y, xlim = c(-100,100), ylim = c(-100, 100), pch = 19, cex = 0.5)
plot(x, y, xlim = c(0,100), ylim = c(0, 100), pch = 19, cex = 0.5)
head((d$Mass))
plot(d$Mass~d$Tarsus, ylab = "Mass (g)", xlab = "Tarsus (mm)", pch=19, cex=0.4, ylim=c(-5,38), xlim=c(0,22))
plot(d$Mass~d$Tarsus, ylab = "Mass (g)", xlab = "Tarsus (mm)", pch=19, cex=0.4)
d1 <- subset(d, d$Mass!="NA")
d2 <- subset(d, d$Tarsus!="NA")
length(d2$Tarsus)
length(d$Tarsus)
d2 <- subset(d, d$Tarsus!="NA")
length(d2$Tarsus)
model1 <- lm(Mass~Tarsus, data = d2)
summary(model1)
hist(model1$residuals)
model2 <- lm(y~x)
summary(model2)
d2$z.Tarsus <- scale(d2$Tarsus)
model3 <- lm(Mass~z.Tarsus, data = d2)
summary(model3)
rm(list=ls())
y <- rnorm(51, mean=1, sd=1.3)
x <- seq(from=0, to=5, by=0.1)
length(x)
plot(hist(y, breaks=10))
mean(y)
sd(y)
segments(x0=(mean(y)), y0=(0), x1=(mean(y)), y1=40, lty=1, col="blue")
segments(x0=(mean(y)+0.25*sd(y)), y0=(0), x1=(mean(y)+0.25*sd(y)), y1=40, lty=1, col="red")
wp.t(d=0.25, power=0.8, type="two sample", alternative="two sided")
library(tidyverse)
wp.t(d=0.25, power=0.8, type="two sample", alternative="two sided")
install.packages("WebPower")
library(WebPower)
wp.t(d=0.25, power=0.8, type="two sample", alternative="two sided")
wp.t(d=0.25, power=0.8, type="two sample", alternative="two.sided")
wp.t(d=0.25, power=0.8, type="two.sample", alternative="two.sided")
res.1 <- wp.t(n1=seq(20,300,20), n2=seq(20,300,20), d=0.25, type = "two.sample.2n", alternative = "two.sided")
res.1
plot(res.1, xvar = 'n1', yvar = 'power')
wp.t(d=0.11, alpha = 0.044, n1=300, n2=300, type = "two.sample")
y <- -1 + 2x - 0.15x^2
y <- -1+2x-0.15x^2
y <- (-1)+2x-0.15x^2
y<-(-1)+2x-0.15x^2
y <- -1 + 2x - (0.15x^2)
y <- -1 + 2 * x - (0.15* x^2)
rm(list = ls())
y1 <- rnorm(10, mean=0, sd=sqrt(1))
var(y1)
y2 <- rnorm(10, mean=0, sd=sqrt(10))
var(y2)
y3 <- rnorm(10, mean=0, sd=sqrt(100))
var(y3)
x <- rep(0,10)
par(mfrow = c(1, 3))
plot(x, y1, xlim=c(-0.1,0.1), ylim=c(-12,12), pch=19, cex=0.8, col="red")
abline(v=0)
abline(h=0)
plot(x, y2, xlim=c(-0.1,0.1), ylim=c(-12,12), pch=19, cex=0.8, col="blue")
abline(v=0)
abline(h=0)
plot(x, y3, xlim=c(-0.1,0.1), ylim=c(-12,12), pch=19, cex=0.8, col="darkgreen")
abline(v=0)
abline(h=0)
plot(x, y2, xlim=c(-12,12), ylim=c(-12,12), pch=19, cex=0.8, col="blue")
abline(v=0)
abline(h=0)
for (i in 1:length(y2)) {
polygon(x=c(0,0,y2[i],y2[i]),y=c(0,y2[i],y2[i],0), col=rgb(0, 0, 1,0.2))
}
plot(x, y3, xlim=c(-12,12), ylim=c(-12,12), pch=19, cex=0.8,, col="darkgreen"
)
abline(v=0)
abline(h=0)
for (i in 1:length(y3)) {
polygon(x=c(0,0,y3[i],y3[i]),y=c(0,y3[i],y3[i],0), col=rgb(0, 1, 0,0.2))
}
rm(list=ls())
daphnia <- read.delim("../data/daphnia.txt")
summary(daphnia)
head(daphnia)
str(daphnia)
par(mfrow = c(1, 2))
plot(Growth.rate ~as.factor(Detergent), data = daphnia)
plot(Growth.rate ~as.factor(daphnia), data = daphnia)
plot(Growth.rate ~as.factor(Daphnia), data = daphnia)
require(tidyverse)
daphnia %>%
group_by(Detergent) %>%
summarise(variance=var(Growth.rate))
daphnia %>%
group_by(Daphnia) %>%
summarise(variance=var(Growth.rate))
hist(daphnia$Growth.rate)
default_par <- par(no.readonly = T)
par(default_par)
hist(daphnia$Growth.rate)
hist(daphnia$Water)
hist(daphnia$Growth.rate)
hist(daphnia$Growth.rate)
hist(daphnia$Growth.rate)
par(mfrow = c(1,1))
hist(daphnia$Growth.rate)
hist(log(daphnia$Growth.rate))
seFun <- function(x) {
sqrt(var(x)/length(x))
}
detergentMean <- with(daphnia, tapply(Growth.rate, INDEX = Detergent,
FUN = mean))
detergentSEM <- with(daphnia, tapply(Growth.rate, INDEX = Detergent,
FUN = seFun))
cloneMean <- with(daphnia, tapply(Growth.rate, INDEX = Daphnia, FUN = mean))
cloneSEM <- with(daphnia, tapply(Growth.rate, INDEX = Daphnia, FUN = seFun))
par(mfrow=c(2,1),mar=c(4,4,1,1))
barMids <- barplot(detergentMean, xlab = "Detergent type", ylab = "Population
growth rate",
ylim = c(0, 5))
arrows(barMids, detergentMean - detergentSEM, barMids, detergentMean +
detergentSEM, code = 3, angle = 90)
barMids <- barplot(cloneMean, xlab = "Daphnia clone", ylab = "Population grow
th rate",
ylim = c(0, 5))
arrows(barMids, cloneMean - cloneSEM, barMids, cloneMean + cloneSEM,
code = 3, angle = 90)
daphniaMod <- lm(Growth.rate ~ Detergent + Daphnia, data = daphnia)
summary(daphniaMod)
detergentMean ~ detergentMean[1]
cov(x, y3)
rm(list = ls())
y1 <- rnorm(10, mean=0, sd=sqrt(1))
var(y1)
y2 <- rnorm(10, mean=0, sd=sqrt(10))
var(y2)
y3 <- rnorm(10, mean=0, sd=sqrt(100))
var(y3)
x <- rep(0,10)
par(mfrow = c(1, 3))
plot(x, y1, xlim=c(-0.1,0.1), ylim=c(-12,12), pch=19, cex=0.8, col="red")
abline(v=0)
abline(h=0)
plot(x, y2, xlim=c(-0.1,0.1), ylim=c(-12,12), pch=19, cex=0.8, col="blue")
abline(v=0)
abline(h=0)
plot(x, y3, xlim=c(-0.1,0.1), ylim=c(-12,12), pch=19, cex=0.8, col="darkgreen")
abline(v=0)
abline(h=0)
par(mfrow = c(1, 3))
plot(x, y1, xlim=c(-12,12), ylim=c(-12,12), pch=19, cex=0.8, col="red")
abline(v=0)
abline(h=0)
polygon(x=c(0,0,y1[1],y1[1]),y=c(0,y1[1],y1[1],0), col=rgb(1, 0, 0,0.2))
polygon(x=c(0,0,y1[2],y1[2]),y=c(0,y1[2],y1[2],0), col=rgb(1, 0, 0,0.2))
polygon(x=c(0,0,y1[3],y1[3]),y=c(0,y1[3],y1[3],0), col=rgb(1, 0, 0,0.2))
polygon(x=c(0,0,y1[4],y1[4]),y=c(0,y1[4],y1[4],0), col=rgb(1, 0, 0,0.2))
polygon(x=c(0,0,y1[4],y1[4]),y=c(0,y1[4],y1[4],0), col=rgb(1, 0, 0,0.2))
polygon(x=c(0,0,y1[5],y1[5]),y=c(0,y1[5],y1[5],0), col=rgb(1, 0, 0,0.2))
polygon(x=c(0,0,y1[6],y1[6]),y=c(0,y1[6],y1[6],0), col=rgb(1, 0, 0,0.2))
polygon(x=c(0,0,y1[7],y1[7]),y=c(0,y1[7],y1[7],0), col=rgb(1, 0, 0,0.2))
polygon(x=c(0,0,y1[8],y1[8]),y=c(0,y1[8],y1[8],0), col=rgb(1, 0, 0,0.2))
polygon(x=c(0,0,y1[9],y1[9]),y=c(0,y1[9],y1[9],0), col=rgb(1, 0, 0,0.2))
polygon(x=c(0,0,y1[10],y1[10]),y=c(0,y1[10],y1[10],0), col=rgb(1, 0, 0,0.2))
plot(x, y2, xlim=c(-12,12), ylim=c(-12,12), pch=19, cex=0.8, col="blue")
abline(v=0)
abline(h=0)
for (i in 1:length(y2)) {
polygon(x=c(0,0,y2[i],y2[i]),y=c(0,y2[i],y2[i],0), col=rgb(0, 0, 1,0.2))
}
plot(x, y3, xlim=c(-12,12), ylim=c(-12,12), pch=19, cex=0.8,, col="darkgreen"
)
abline(v=0)
abline(h=0)
for (i in 1:length(y3)) {
polygon(x=c(0,0,y3[i],y3[i]),y=c(0,y3[i],y3[i],0), col=rgb(0, 1, 0,0.2))
}
par(mfrow = c(1, 3))
plot(x, y1, xlim=c(-12,12), ylim=c(-12,12) ,pch=19, cex=0.8, col="red")
abline(v=0)
abline(h=0)
polygon(x=c(0,0,y1[1],y1[1]),y=c(0,y1[1],y1[1],0), col=rgb(1, 0, 0,0.2))
polygon(x=c(0,0,y1[2],y1[2]),y=c(0,y1[2],y1[2],0), col=rgb(1, 0, 0,0.2))
polygon(x=c(0,0,y1[3],y1[3]),y=c(0,y1[3],y1[3],0), col=rgb(1, 0, 0,0.2))
polygon(x=c(0,0,y1[4],y1[4]),y=c(0,y1[4],y1[4],0), col=rgb(1, 0, 0,0.2))
polygon(x=c(0,0,y1[4],y1[4]),y=c(0,y1[4],y1[4],0), col=rgb(1, 0, 0,0.2))
polygon(x=c(0,0,y1[5],y1[5]),y=c(0,y1[5],y1[5],0), col=rgb(1, 0, 0,0.2))
polygon(x=c(0,0,y1[6],y1[6]),y=c(0,y1[6],y1[6],0), col=rgb(1, 0, 0,0.2))
polygon(x=c(0,0,y1[7],y1[7]),y=c(0,y1[7],y1[7],0), col=rgb(1, 0, 0,0.2))
polygon(x=c(0,0,y1[8],y1[8]),y=c(0,y1[8],y1[8],0), col=rgb(1, 0, 0,0.2))
polygon(x=c(0,0,y1[9],y1[9]),y=c(0,y1[9],y1[9],0), col=rgb(1, 0, 0,0.2))
polygon(x=c(0,0,y1[10],y1[10]),y=c(0,y1[10],y1[10],0), col=rgb(1, 0, 0,0.2))
plot(x, y2, xlim=c(-12,12), ylim=c(-12,12), pch=19, cex=0.8, col="blue")
abline(v=0)
abline(h=0)
for (i in 1:length(y2)) {
polygon(x=c(0,0,y2[i],y2[i]),y=c(0,y2[i],y2[i],0), col=rgb(0, 0, 1,0.2))
}
plot(x, y3, xlim=c(-12,12), ylim=c(-12,12), pch=19, cex=0.8,, col="darkgreen"
)
abline(v=0)
abline(h=0)
for (i in 1:length(y3)) {
polygon(x=c(0,0,y3[i],y3[i]),y=c(0,y3[i],y3[i],0), col=rgb(0, 1, 0,0.2))
}
rm(list = ls())
par(mfrow = c(1, 3))
x<-c(-10:10)
var(x)
y1<-x*1 + rnorm(21, mean=0, sd=sqrt(1))
cov(x, y1)
plot(x, y1, xlim=c(-10,10), ylim=c(-20, 20), col="red", pch=19, cex=0.8, main
=paste("Cov=",round(cov(x,y1),digits=2)))
y2<-rnorm(21, mean=0, sd=sqrt(1))
cov(x, y2)
plot(x, y2, xlim=c(-10,10), ylim=c(-20, 20), col="blue", pch=19, cex=0.8, mai
=paste("Cov=",round(cov(x,y2),digits=2)))
y3<- x* (-1) +rnorm(21, mean=0, sd=sqrt(1))
cov(x, y3)
plot(x, y3, xlim=c(-10,10), ylim=c(-20, 20), col="darkgreen", pch=19, cex=0.8
, main=paste("Cov=",round(cov(x,y3),digits=2)))
rm(list = ls())
par(mfrow = c(1, 3))
x<-c(-10:10)
var(x)
y1<-x*0.1 + rnorm(21, mean=0, sd=sqrt(1))
cov(x, y1)
plot(x, y1, xlim=c(-10,10), ylim=c(-20, 20), col="red", pch=19, cex=0.8, main
=paste("Cov=",round(cov(x,y1),digits=2)))
y2<-x*0.5+ rnorm(21, mean=0, sd=sqrt(1))
cov(x, y2)
plot(x, y2, xlim=c(-10,10), ylim=c(-20, 20), col="blue", pch=19, cex=0.8, main
=paste("Cov=",round(cov(x,y2),digits=2)))
y3<- x*2 +rnorm(21, mean=0, sd=sqrt(1))
cov(x, y3)
plot(x, y3, xlim=c(-10,10), ylim=c(-20, 20), col="darkgreen", pch=19, cex=0.8
, main=paste("Cov=",round(cov(x,y3),digits=2)))
cov(x,y1)
cor(x, y1)
cov(x,y2)
cor(x,y2)
cov(x,y3)
cor(x,y3)
#What	happens	if	we	introduce	variation	in	y?
rm(list = ls())
par(mfrow = c(3, 1))
x<-c(-10:10)
var(x)
y1<-x*1 + rnorm(21, mean=0, sd=sqrt(1))
cov(x, y1)
plot(x, y1, xlim=c(-10,10), ylim=c(-20, 20), col="red", pch=19, cex=0.8, main
=paste("Cov=",round(cov(x,y1),digits=2)," Cor=",round(cor(x,y1),digits=2)))
y2<-x*1 + rnorm(21, mean=0, sd=sqrt(10))
cov(x, y2)
plot(x, y2, xlim=c(-10,10), ylim=c(-20, 20), col="blue", pch=19, cex=0.8, mai
=paste("Cov=",round(cov(x,y2),digits=2)," Cor=",round(cor(x,y2),digits=2)))
y3<- x*1 + rnorm(21, mean=0, sd=sqrt(100))
cov(x, y3)
plot(x, y3, xlim=c(-10,10), ylim=c(-20, 20), col="darkgreen", pch=19, cex=0.8
, main=paste("Cov=",round(cov(x,y3),digits=2)," Cor=",round(cor(x,y3),digits=
2)))
rm(list=ls())
daphnia <- read.delim("../data/daphnia.txt")
summary(daphnia)
par(mfrow = c(1, 2))
plot(Growth.rate ~ as.factor(Detergent), data = daphnia)
plot(Growth.rate ~ as.factor(Daphnia), data = daphnia)
require(tidyverse)
daphnia %>%
group_by(Detergent) %>%
summarise (variance=var(Growth.rate))
daphnia %>%
group_by(Daphnia) %>%
summarise (variance=var(Growth.rate))
hist(daphnia$Growth.rate)
par(mfrow = c(1, 1))
hist(daphnia$Growth.rate)
seFun <- function(x) {
sqrt(var(x)/length(x))
}
detergentMean <- with(daphnia, tapply(Growth.rate, INDEX = Detergent, FUN = mean))
detergentSEM <- with(daphnia, tapply(Growth.rate, INDEX = Daphnia, FUN = seFUN))
detergentSEM <- with(daphnia, tapply(Growth.rate, INDEX = Daphnia, FUN = seFun))
cloneMean <- with(daphnia, tapply(Growth.rate, INDEX = Daphnia, FUN = mean))
cloneSEM <- with(daphnia, tapply(Growth.rate, INDEX = Daphnia, FUN = seFun))
par(mfrow = c(2,1), mar=c(4, 4, 1, 1))
barMids <- barplot(detergentMean, xlab = "Detergent type", ylab = "Population growth rate", ylim = c(0, 5))
arrows(barMids, detergentMean, detergentSEM, barMids, detergentMean + detergentSEM, code = 3, angle = 90)
barMids <- barplot(cloneMean, xlab = "Daphnia clone", ylab = "Population growth rate", ylim = c(0, 5))
arrows(barMids, cloneMean - cloneSEM, barMids, cloneMean + cloneSEM, code = 3, angle = 90)
arrows(barMids, detergentMean, detergentSEM, barMids, detergentMean + detergentSEM, code = 3, angle = 90)
arrows(barMids, detergentMean - detergentSEM, barMids, detergentMean + detergentSEM, code = 3, angle = 90)
par(mfrow = c(2,1), mar=c(4, 4, 1, 1))
barMids <- barplot(detergentMean, xlab = "Detergent type", ylab = "Population growth rate", ylim = c(0, 5))
arrows(barMids, detergentMean - detergentSEM, barMids, detergentMean + detergentSEM, code = 3, angle = 90)
length(detergentMean)
length(detergentSEM)
detergentMean <- with(daphnia, tapply(Growth.rate, INDEX = Detergent, FUN = mean))
detergentSEM <- with(daphnia, tapply(Growth.rate, INDEX = Daphnia, FUN = seFun))
detergentSEM <- with(daphnia, tapply(Growth.rate, INDEX = Detergent, FUN = seFun))
cloneMean <- with(daphnia, tapply(Growth.rate, INDEX = Daphnia, FUN = mean))
cloneSEM <- with(daphnia, tapply(Growth.rate, INDEX = Daphnia, FUN = seFun))
par(mfrow = c(2,1), mar=c(4, 4, 1, 1))
barMids <- barplot(detergentMean, xlab = "Detergent type", ylab = "Population growth rate", ylim = c(0, 5))
arrows(barMids, detergentMean - detergentSEM, barMids, detergentMean + detergentSEM, code = 3, angle = 90)
barMids <- barplot(cloneMean, xlab = "Daphnia clone", ylab = "Population growth rate", ylim = c(0, 5))
arrows(barMids, cloneMean - cloneSEM, barMids, cloneMean + cloneSEM, code = 3, angle = 90)
daphniaMod <- lm(Growth.rate ~ Detergent + Daphnia, data = daphnia)
summary(daphniaMod)
detergentMean - detergentMean[1]
cloneMean - cloneMean[1]
daphniaANOVAMod <- aov(Growth.rate ~ Detergent + Daphnia, data = daphnia)
summary(daphniaANOVAMod)
daphniaModHSD <- TurkeyHSD(daphniaANOVAMod)
daphniaModHSD <- TukeyHSD(daphniaANOVAMod)
daphniaModHSD <- TukeyHSD(daphniaANOVAMod)
daphniaModHSD
par(mfrow=c(2 ,1), mar=c(4, 4, 1, 1))
plot(daphniaModHSD)
par(mfrow=c(2, 2))
plot(daphniaMod)
#Multiple regression with timber.txt
timber <- read.delim("../data/timber.txt")
summary(timber)
str(timber)
head(timber)
par(mfrow = c(2, 2))
boxplot(timber$volume)
boxplot(timber$girth)
boxplot(timber$height)
# Load necessary package for easy data manipulation (if not already installed)
if (!require("dplyr")) install.packages("dplyr", dependencies = TRUE)
library(dplyr)
# Create a data frame of predicted values from the model
predicted_df <- daphnia %>%
mutate(predicted = predict(daphniaMod)) %>%
group_by(Detergent, Daphnia) %>%
summarize(mean_growth = mean(predicted), .groups = 'drop')
# Plot
library(ggplot2)
ggplot(predicted_df, aes(x = Detergent, y = mean_growth, fill = Daphnia)) +
geom_bar(stat = "identity", position = position_dodge(width = 0.8)) +
labs(x = "Detergent Brand", y = "Predicted Growth Rate", title = "Predicted Growth Rate by Detergent and Daphnia Clone") +
theme_minimal() +
theme(legend.position = "top") +
scale_fill_brewer(palette = "Set2")
var(timber$volume)
var(timber$girth)
var(timber$height)
t2 <- as.data.frame(subset(timber, timber$volume!="NA"))
t2$z.grith <- scale(timber$girth)
t2$z.height <- scale(timber$height)
var(t2$z.girth)
View(timber)
plot(timber$volume, timber$girth, timber$height)
plot(timber$volume, timber$girth)
plot(timber$volume, timber$height)
plot(timber$grith, timber$height)
t2 <- as.data.frame(subset(timber, timber$volume!="NA"))
t2$z.grith <- scale(timber$girth)
t2$z.height <- scale(timber$height)
var(t2$z.girth)
var(t2$z.height)
par(mfrow = C(1,1))
plot(t2)
hist(t2$volume)
hist(t2$girth)
hist(t2$height)
pairs(timber)
cor(timber)
summary(lm(girth ~ height, data = timber))
VIF <- 1/(1-0.27)
VIF
sqrt(VIF)
pairs(timber)
cor(timber)
pairs(t2)
cor(t2)
timberMod <- lm(volume ~ girth + height, data = timber)
anova(timberMod)
summary(timberMod)
plot(timberMod)
setwd("../../week5/code")
